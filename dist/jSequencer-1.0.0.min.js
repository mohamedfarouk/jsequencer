!function(a,b){"function"==typeof define&&define.amd?define(["exports"],function(c){a.JSequencer=b(a,c)}):"undefined"!=typeof exports?b(a,exports):a.JSequencer=b(a,{})}(this,function(a,b){function c(a,b,c){function d(b,c){var d=a[b].context,e=a[b].func,g=a[b].params;"function"==typeof g&&(g=g.call(d)),g instanceof Array?(g.push(c),g.push(this)):g=[g,c,this],m.call(this,f,n);var h=e.apply(d,g);return h}function l(b,e){n=b;var f;try{f=d.call(this,n,e)}catch(j){p[n]=void 0,m.call(this,h,n,j,e)}if(o!==i){if(p[n]=f,c.call(this,g,f),n>=a.length-1)return void m.call(this,k,n,f);n++,l.call(this,n,f)}}function m(a){o=a,c.apply(this,arguments)}var n,o=e,p=[],q={};this.start=function(a){n=0,l.call(this,n,a)},this.pause=function(){if(o!==f)throw"cannot call pause unless state is "+f+" current state is "+o;m.call(this,i,n)},this.resume=function(b){if(o!==i&&o!==h)throw"cannot call resume unless state is "+i+"or "+h+" current state is "+o;return m.call(this,j,n),p[n]=b,c.call(this,g,n,b),n>=a.length-1?void m.call(this,k,n,b):(n++,void l.call(this,n,b))},this["break"]=function(a){if(o!==f&&o!==i)throw"cannot call pause unless state is "+f+" or "+i+" current state is "+o;m.call(this,k,n,a)},this.getCurrentStep=function(){return n},this.getResults=function(){var a=[];for(var b in p)a.push(p[b]);return a},this.set=function(a,b){q[a]=b},this.get=function(a){return q[a]}}var d=a.JSequencer;b.VERSION="1.0.0",b.noConflict=function(){return a.JSequencer=d,this};var e=b.STAT_NOT_STARTED="NOT_STARTED",f=b.STAT_EXECUTING="EXECUTING",g=b.STAT_STEP_EXECUTED="STEP_EXECUTED",h=b.STAT_ERROR="ERROR",i=b.STAT_PAUSED="PAUSED",j=b.STAT_RESUMED="RESUMED",k=b.STAT_COMPLETED="COMPLETED",l=b.STAT_FAILED="FAILED";return b.Sequencer=function(a){function b(c,v){if(c===k)"function"==typeof f&&f.call(m,this,arguments[2]);else if(c===g)"function"==typeof d&&d.call(e,this);else if(c===i)"function"==typeof r&&r.call(s,this);else if(c===l){if("function"==typeof p){var w={stepIndex:v,error:arguments[2],lastResult:arguments[3]};p.call(q,this,w)}}else if(c===h){var w={stepIndex:v,resume:a.resumeOnError,error:arguments[2],lastResult:arguments[3],newResult:void 0};if("function"==typeof n&&n.call(o,this,w),w.resume){var x=void 0===w.newResult?w.lastResult:w.newResult;this.resume(x)}else b.call(this,l,v,arguments[2],arguments[3])}else c===j&&"function"==typeof t&&t.call(u,this)}var d,e,f,m,n,o,p,q,r,s,t,u,v=[];(void 0===a.defaultContext||null===a.defaultContext)&&(a.defaultContext=this),(void 0===a.resumeOnError||null===a.resumeOnError)&&(a.resumeOnError=!1);var w=null;w=new c(v,a.resumeOnError,b),this.add=function(b,c,d){if("object"==typeof b&&arguments.length>1)throw"parameters can be either passed as single object or arguments, not both";return"object"==typeof b&&(c=b.context,d=b.params,b=b.func),(null===c||void 0===c)&&(c=a.defaultContext),(null===d||void 0===d)&&(d=[]),v.push({context:c,params:d,func:b}),this},this.onStep=function(b,c){return d=b,e=void 0===c||null===c?a.defaultContext:c,this},this.onCompleted=function(b,c){return f=b,m=void 0===c||null===c?a.defaultContext:c,this},this.onError=function(b,c){return n=b,o=void 0===c||null===c?a.defaultContext:c,this},this.onFailed=function(b,c){return p=b,q=void 0===c||null===c?a.defaultContext:c,this},this.onPaused=function(b,c){return r=b,s=void 0===c||null===c?a.defaultContext:c,this},this.onResumed=function(b,c){return t=b,u=void 0===c||null===c?a.defaultContext:c,this},this.context=function(){return w}},b});