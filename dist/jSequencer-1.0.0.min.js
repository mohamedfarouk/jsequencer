!function(a,b){"function"==typeof define&&define.amd?define(["exports"],function(c){a.JSequencer=b(a,c)}):"undefined"!=typeof exports?b(a,exports):a.JSequencer=b(a,{})}(this,function(a,b){function c(a,b,c){function d(b,c){var d=a[b].context,e=a[b].func,g=a[b].params;"function"==typeof g&&(g=g.call(d)),void 0===g&&(g=[]),g instanceof Array||(g=[g]),g.push(this),g.push(c),n.call(this,f,o);var h=e.apply(d,g);return h}function m(b,e){o=b;var f;try{f=d.call(this,o,e)}catch(j){q[o]=void 0,n.call(this,h,o,j,e)}if(p===l)q[o]=f,n.call(this,k,o,f);else if(p!==i){if(q[o]=f,c.call(this,g,f),o>=a.length-1)return void n.call(this,k,o,f);o++,m.call(this,o,f)}}function n(a){p=a,c.apply(this,arguments)}var o,p=e,q=[],r={};this.start=function(a){o=0,m.call(this,o,a)},this.pause=function(){if(p!==f)throw"cannot call pause unless state is "+f+" current state is "+p;n.call(this,i,o)},this.resume=function(b){if(p!==i&&p!==h)throw"cannot call resume unless state is "+i+"or "+h+" current state is "+p;return n.call(this,j,o),q[o]=b,c.call(this,g,o,b),o>=a.length-1?void n.call(this,k,o,b):(o++,void m.call(this,o,b))},this["break"]=function(a){if(p!==f&&p!==i)throw"cannot call pause unless state is "+f+" or "+i+" current state is "+p;n.call(this,l,o,a)},this.getCurrentStep=function(){return o},this.getResults=function(){var a=[];for(var b in q)a.push(q[b]);return a},this.set=function(a,b){r[a]=b},this.get=function(a){return r[a]},this.state=function(){return p}}var d=a.JSequencer;b.VERSION="1.0.0",b.noConflict=function(){return a.JSequencer=d,this};var e=b.STAT_NOT_STARTED="NOT_STARTED",f=b.STAT_EXECUTING="EXECUTING",g=b.STAT_STEP_EXECUTED="STEP_EXECUTED",h=b.STAT_ERROR="ERROR",i=b.STAT_PAUSED="PAUSED",j=b.STAT_RESUMED="RESUMED",k=b.STAT_COMPLETED="COMPLETED",l=b.STAT_FAILED="BREAK",m=b.STAT_FAILED="FAILED";return b.Sequencer=function(a){function b(c,y){if(c===k&&"function"==typeof f&&f.call(n,this,arguments[2]),c===l)"function"==typeof o&&o.call(p,this,arguments[2]);else if(c===g)"function"==typeof d&&d.call(e,this);else if(c===i)"function"==typeof u&&u.call(v,this);else if(c===m){if("function"==typeof s){var z={stepIndex:y,error:arguments[2],lastResult:arguments[3]};s.call(t,this,z)}}else if(c===h){var z={stepIndex:y,resume:a.resumeOnError,error:arguments[2],lastResult:arguments[3],newResult:void 0};if("function"==typeof q&&q.call(r,this,z),z.resume){var A=void 0===z.newResult?z.lastResult:z.newResult;this.resume(A)}else b.call(this,m,y,arguments[2],arguments[3])}else c===j&&"function"==typeof w&&w.call(x,this)}var d,e,f,n,o,p,q,r,s,t,u,v,w,x,y=[];(void 0===a.defaultContext||null===a.defaultContext)&&(a.defaultContext=this),(void 0===a.resumeOnError||null===a.resumeOnError)&&(a.resumeOnError=!1);var z=null;z=new c(y,a.resumeOnError,b),this.add=function(b,c,d){if("object"==typeof b&&arguments.length>1)throw"parameters can be either passed as single object or arguments, not both";return"object"==typeof b&&(c=b.context,d=b.params,b=b.func),(null===c||void 0===c)&&(c=a.defaultContext),(null===d||void 0===d)&&(d=[]),y.push({context:c,params:d,func:b}),this},this.onStep=function(b,c){return d=b,e=void 0===c||null===c?a.defaultContext:c,this},this.onCompleted=function(b,c){return f=b,n=void 0===c||null===c?a.defaultContext:c,this},this.onError=function(b,c){return q=b,r=void 0===c||null===c?a.defaultContext:c,this},this.onFailed=function(b,c){return s=b,t=void 0===c||null===c?a.defaultContext:c,this},this.onPaused=function(b,c){return u=b,v=void 0===c||null===c?a.defaultContext:c,this},this.onResumed=function(b,c){return w=b,x=void 0===c||null===c?a.defaultContext:c,this},this.context=function(){return z}},b});